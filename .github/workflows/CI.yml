name: CI

on:
  push:
  pull_request:

jobs:
 report:
    runs-on: windows-latest
    steps:
     - uses: actions/checkout@v2
     - name: Create report file
       run: date +%s > report.txt
     - name: Commit report
       run: |
          git config --global user.name 'Minionguyjpro'
          git config --global user.email 'minionguyjpro@users.noreply.github.com'
          git commit -am "Automated report"
          git push
    
     - name: Checkout
       uses: actions/checkout@v2
       with:
         fetch-depth: 0

     - name: Checkout fred
       uses: actions/checkout@v2
       with:
         repository: 'freenet/fred'
         fetch-depth: 0
         path: 'fred'

     - name: Download fred from the Github Release
       uses: i3h/download-release-asset@v1.2.0
       with:
         owner: "freenet"
         repo: "fred"
         tag: "latest"
         file: "freenet.jar"

     - uses: eskatos/gradle-command-action@v1
       with:
         arguments: updateSetupFile
        
     - name: Building the installer
       run: |
         "%programfiles(x86)%\Inno Setup 6\iscc.exe" "Ghostly Skills.iss"
       shell: cmd

     - name: Download all workflow run artifacts
       uses: actions/download-artifact@v2
